<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Projects — Nicholas Kadunce</title>
  <meta name="description" content="Tools and systems built to drive operational excellence - JMOS Dashboard, Excel automation, and more.">
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <nav class="nav">
    <div class="nav-inner">
      <div class="nav-left">
        <button class="nav-profile" aria-label="View profile photo">
          <img src="/media/images/Nick.jpg" alt="Nicholas Kadunce" class="nav-avatar">
        </button>
        <a href="#" class="nav-signature-link">
          <img src="/media/images/white-signature.png" alt="" class="nav-signature">
        </a>
      </div>
      <a href="/" class="nav-brand">Nicholas Kadunce</a>
      <div class="nav-right">
        <button class="theme-toggle" aria-label="Toggle dark/light mode">
          <svg class="theme-icon sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="4"/>
            <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/>
          </svg>
          <svg class="theme-icon moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
        <div class="nav-toggle-wrapper">
          <button class="nav-toggle" aria-label="Toggle menu" aria-expanded="false">
            <span class="hamburger"></span>
          </button>
          <div class="nav-menu">
            <a href="/#experience">Experience</a>
            <a href="projects.html">Projects</a>
            <a href="/#contact">Contact</a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Profile Image Popup -->
  <div class="profile-overlay" id="profile-overlay">
    <div class="profile-popup">
      <button class="profile-close" aria-label="Close profile photo">&times;</button>
      <img src="/media/images/Nick.jpg" alt="Nicholas Kadunce">
    </div>
  </div>

  <main>
    <!-- Projects Section -->
    <section class="projects-page">
      <div class="container">
        <div class="projects-header reveal">
          <h2>Projects</h2>
          <p class="text-large">Tools and systems I've built to drive operational excellence.</p>
        </div>

        <!-- JMOS Dashboard Project -->
        <div class="project-card reveal">
          <div class="project-preview">
            <div class="project-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <path d="M3 9h18"/>
                <path d="M9 21V9"/>
              </svg>
            </div>
            <div class="project-info">
              <h3>Operations Daily Dashboard</h3>
              <p>Interactive daily operations email with real-time KPIs, downtime analysis, quality metrics, and action tracking—sent automatically each morning.</p>
              <div class="project-tags">
                <span>VBA</span>
                <span>Outlook</span>
                <span>Excel</span>
                <span>Automation</span>
              </div>
            </div>
            <button class="project-expand" aria-expanded="false" data-target="jmos-dashboard">
              <span>View Demo</span>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 18l6-6-6-6"/>
              </svg>
            </button>
          </div>

          <!-- Expanded Dashboard Demo -->
          <div class="project-demo" id="jmos-dashboard">
            <div class="dashboard-container">
              <div class="dashboard-nav">
                <div class="dash-nav-hint">
                  <span>Explore sections</span>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 5v14M5 12l7 7 7-7"/>
                  </svg>
                </div>
                <div class="dash-nav-buttons">
                  <button class="dash-nav-btn active" data-section="overview">Dashboard</button>
                  <button class="dash-nav-btn" data-section="downtime">Downtime</button>
                  <button class="dash-nav-btn" data-section="quality">Quality</button>
                  <button class="dash-nav-btn" data-section="safety">Safety</button>
                  <button class="dash-nav-btn" data-section="maintenance">Maintenance</button>
                  <button class="dash-nav-btn" data-section="keystone">Financial Forecaster</button>
                  <button class="dash-nav-btn" data-section="actions">Action Items</button>
                </div>
              </div>

              <div class="dashboard-content">
                <!-- Overview Section -->
                <div class="dash-section active" id="dash-overview">
                  <div class="dash-header">
                    <h4>Daily Operations Dashboard</h4>
                    <p>Real-time visibility into production, safety, quality, and maintenance metrics—built for morning stand-ups and executive review.</p>
                  </div>
                  <div class="dash-chart">
                    <img src="/media/images/dashboard.png" alt="JMOS Daily Operations Dashboard showing production metrics by machine and operator">
                  </div>
                </div>

                <!-- Downtime Section -->
                <div class="dash-section" id="dash-downtime">
                  <div class="dash-header">
                    <h4>Downtime Analysis</h4>
                    <p>Hour-by-hour Pareto analysis of production losses, categorized by root cause for targeted improvement.</p>
                  </div>
                  <div class="dash-chart">
                    <img src="/media/images/downtime.png" alt="Equipment downtime bar chart showing hours by equipment">
                  </div>
                </div>

                <!-- Quality Section -->
                <div class="dash-section" id="dash-quality">
                  <div class="dash-header">
                    <h4>Quality Metrics</h4>
                    <p>Defect rates, rework tracking, and quality trends across production lines.</p>
                  </div>
                  <div class="dash-chart">
                    <img src="/media/images/quality.png" alt="Quality testing volume and pass rates by product type">
                  </div>
                </div>

                <!-- Safety Section -->
                <div class="dash-section" id="dash-safety">
                  <div class="dash-header">
                    <h4>Safety Dashboard</h4>
                    <p>Incident tracking, near-miss reports, and safety observation trends.</p>
                  </div>
                  <div class="dash-chart">
                    <img src="/media/images/safety.png" alt="Safety pyramid showing leading and lagging indicators">
                  </div>
                </div>

                <!-- Maintenance Section -->
                <div class="dash-section" id="dash-maintenance">
                  <div class="dash-header">
                    <h4>Maintenance Tracker</h4>
                    <p>Work order status, PM completion rates, and equipment reliability metrics.</p>
                  </div>
                  <div class="dash-chart">
                    <img src="/media/images/maintenance.png" alt="Maintenance work orders by type and asset">
                  </div>
                </div>

                <!-- Financial Forecaster Section -->
                <div class="dash-section" id="dash-keystone">
                  <div class="dash-header">
                    <h4>Financial Forecaster</h4>
                    <p>Forecasting tool integrating market data with production capacity for optimized scheduling.</p>
                  </div>
                  <div class="dash-chart">
                    <img src="/media/images/keystone.png" alt="Keystone forecasting charts showing actual vs forecast trends">
                  </div>
                </div>

                <!-- Action Items Section -->
                <div class="dash-section" id="dash-actions">
                  <div class="dash-header">
                    <h4>Action Items</h4>
                    <p>Tracked issues and follow-up items with ownership and due dates.</p>
                  </div>
                  <div class="dash-chart">
                    <img src="/media/images/action-items.png" alt="Action items tracker with assignments and status">
                  </div>
                </div>
              </div>
            </div>
            <p class="dashboard-note">This interactive demo mirrors the automated daily email sent to plant leadership each morning.</p>
          </div>
        </div>

        <!-- Financial Forecaster Video Project -->
        <div class="project-card reveal">
          <div class="project-preview">
            <div class="project-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
                <circle cx="12" cy="12" r="4"/>
              </svg>
            </div>
            <div class="project-info">
              <h3>Financial Forecaster</h3>
              <p>Data-driven forecasting tool using 3-month rolling averages to generate daily financial projections, strengthening performance and improving oversight efficiency.</p>
              <div class="project-tags">
                <span>VBA</span>
                <span>Excel</span>
                <span>Forecasting</span>
                <span>Analytics</span>
              </div>
            </div>
            <button class="project-expand" aria-expanded="false" data-target="financial-forecaster">
              <span>View Demo</span>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 18l6-6-6-6"/>
              </svg>
            </button>
          </div>

          <!-- Video Demo -->
          <div class="project-demo" id="financial-forecaster">
            <div class="video-demo-container">
              <div class="video-header">
                <h4>Financial Forecaster</h4>
                <p>Financial Forecaster is a data-driven forecasting tool that uses 3-month rolling averages to generate daily financial projections from the most recent actuals. It streamlines consolidation and analysis to strengthen financial performance and improve the efficiency of financial oversight, with planned enhancements including seasonal weighting and advanced statistical methods as more historical data is collected.</p>
              </div>
              <div class="video-player-wrapper">
                <video id="forecaster-video" class="video-player" preload="metadata">
                  <source src="/media/gifs/Keystone-Scraper.mp4" type="video/mp4">
                  Your browser does not support the video tag.
                </video>
                <div class="video-controls">
                  <button class="video-play-btn" aria-label="Play/Pause">
                    <svg class="play-icon" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M8 5v14l11-7z"/>
                    </svg>
                    <svg class="pause-icon" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M6 4h4v16H6zM14 4h4v16h-4z"/>
                    </svg>
                  </button>
                  <div class="video-progress-container">
                    <input type="range" class="video-progress" value="0" min="0" max="100" step="0.1">
                    <div class="video-progress-bar"></div>
                  </div>
                  <span class="video-time">0:00 / 0:00</span>
                  <button class="video-fullscreen-btn" aria-label="Toggle fullscreen">
                    <svg class="expand-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M8 3H5a2 2 0 0 0-2 2v3M21 8V5a2 2 0 0 0-2-2h-3M3 16v3a2 2 0 0 0 2 2h3M16 21h3a2 2 0 0 0 2-2v-3"/>
                    </svg>
                    <svg class="compress-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M4 14h3a2 2 0 0 1 2 2v3M20 14h-3a2 2 0 0 0-2 2v3M4 10h3a2 2 0 0 0 2-2V5M20 10h-3a2 2 0 0 1-2-2V5"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Future Project Placeholder -->
        <div class="project-card reveal coming-soon">
          <div class="project-preview">
            <div class="project-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="7"/>
                <rect x="14" y="3" width="7" height="7"/>
                <rect x="14" y="14" width="7" height="7"/>
                <rect x="3" y="14" width="7" height="7"/>
              </svg>
            </div>
            <div class="project-info">
              <h3>Excel Macro Dashboards</h3>
              <p>Automated reporting tools with VBA macros, dynamic data connections, and one-click exports.</p>
              <div class="project-tags">
                <span>VBA</span>
                <span>Excel</span>
                <span>Power Query</span>
              </div>
            </div>
            <div class="coming-soon-badge">Coming Soon</div>
          </div>
        </div>

      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <p>&copy; <span id="year"></span> Nicholas Kadunce</p>
      </div>
    </footer>
  </main>

  <script>
    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Scroll Reveal
    const revealElements = document.querySelectorAll('.reveal, .reveal-stagger');
    const revealObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('revealed');
          revealObserver.unobserve(entry.target);
        }
      });
    }, { threshold: 0.15, rootMargin: '0px 0px -50px 0px' });
    revealElements.forEach(el => revealObserver.observe(el));

    // Nav menu toggle
    const navToggle = document.querySelector('.nav-toggle');
    const navMenu = document.querySelector('.nav-menu');

    navToggle.addEventListener('click', () => {
      const isExpanded = navToggle.getAttribute('aria-expanded') === 'true';
      navToggle.setAttribute('aria-expanded', !isExpanded);
      navMenu.classList.toggle('open');
    });

    // Close menu when clicking a link
    navMenu.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        navToggle.setAttribute('aria-expanded', 'false');
        navMenu.classList.remove('open');
      });
    });

    // Close menu when clicking outside
    document.addEventListener('click', (e) => {
      if (!navToggle.contains(e.target) && !navMenu.contains(e.target)) {
        navToggle.setAttribute('aria-expanded', 'false');
        navMenu.classList.remove('open');
      }
    });

    // Project expand/collapse
    document.querySelectorAll('.project-expand').forEach(button => {
      button.addEventListener('click', () => {
        const isExpanded = button.getAttribute('aria-expanded') === 'true';
        const demo = document.getElementById(button.dataset.target);
        const card = button.closest('.project-card');

        button.setAttribute('aria-expanded', !isExpanded);
        demo.classList.toggle('open');
        card.classList.toggle('expanded');

        // Update button text
        button.querySelector('span').textContent = isExpanded ? 'View Demo' : 'Close Demo';

        // Show hint when opening, reset when closing
        const hint = demo.querySelector('.dash-nav-hint');
        if (hint) {
          if (!isExpanded) {
            hint.classList.remove('hidden');
          } else {
            hint.classList.remove('hidden');
          }
        }
      });
    });

    // Dashboard navigation
    document.querySelectorAll('.dash-nav-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const section = btn.dataset.section;
        const container = btn.closest('.dashboard-container');

        // Update active nav button
        container.querySelectorAll('.dash-nav-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        // Update active section
        container.querySelectorAll('.dash-section').forEach(s => s.classList.remove('active'));
        container.querySelector(`#dash-${section}`).classList.add('active');

        // Hide the hint after first click
        const hint = container.querySelector('.dash-nav-hint');
        if (hint) {
          hint.classList.add('hidden');
        }
      });
    });

    // Theme toggle
    const themeToggle = document.querySelector('.theme-toggle');
    const root = document.documentElement;

    // Check for saved theme preference or default to dark
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
      root.setAttribute('data-theme', savedTheme);
    } else {
      root.setAttribute('data-theme', 'dark');
    }

    themeToggle.addEventListener('click', () => {
      const currentTheme = root.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      root.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    });

    // Profile popup (only avatar triggers it)
    const navProfile = document.querySelector('.nav-profile');
    const profileOverlay = document.getElementById('profile-overlay');
    const profileClose = document.querySelector('.profile-close');

    navProfile.addEventListener('click', (e) => {
      e.preventDefault();
      profileOverlay.classList.add('open');
    });

    profileClose.addEventListener('click', () => {
      profileOverlay.classList.remove('open');
    });

    // Close popup when clicking overlay background
    profileOverlay.addEventListener('click', (e) => {
      if (e.target === profileOverlay) {
        profileOverlay.classList.remove('open');
      }
    });

    // Close popup with Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && profileOverlay.classList.contains('open')) {
        profileOverlay.classList.remove('open');
      }
    });

    // Video Player Controls
    document.querySelectorAll('.video-player-wrapper').forEach(wrapper => {
      const video = wrapper.querySelector('.video-player');
      const playBtn = wrapper.querySelector('.video-play-btn');
      const progressInput = wrapper.querySelector('.video-progress');
      const progressBar = wrapper.querySelector('.video-progress-bar');
      const timeDisplay = wrapper.querySelector('.video-time');
      const fullscreenBtn = wrapper.querySelector('.video-fullscreen-btn');

      // Format time helper
      function formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}:${secs.toString().padStart(2, '0')}`;
      }

      // Update time display
      function updateTime() {
        const current = formatTime(video.currentTime);
        const duration = formatTime(video.duration || 0);
        timeDisplay.textContent = `${current} / ${duration}`;
      }

      // Update progress bar
      function updateProgress() {
        const percent = (video.currentTime / video.duration) * 100 || 0;
        progressInput.value = percent;
        progressBar.style.width = `${percent}%`;
        updateTime();
      }

      // Play/Pause toggle
      playBtn.addEventListener('click', () => {
        if (video.paused) {
          video.play();
        } else {
          video.pause();
        }
      });

      // Update button state on play/pause
      video.addEventListener('play', () => {
        playBtn.classList.add('playing');
      });

      video.addEventListener('pause', () => {
        playBtn.classList.remove('playing');
      });

      // Update progress as video plays
      video.addEventListener('timeupdate', updateProgress);

      // Update duration when loaded
      video.addEventListener('loadedmetadata', updateTime);

      // Seek when clicking progress bar
      progressInput.addEventListener('input', () => {
        const percent = progressInput.value;
        video.currentTime = (percent / 100) * video.duration;
        progressBar.style.width = `${percent}%`;
      });

      // Fullscreen toggle
      fullscreenBtn.addEventListener('click', () => {
        wrapper.classList.toggle('fullscreen');
        if (wrapper.classList.contains('fullscreen')) {
          document.body.style.overflow = 'hidden';
        } else {
          document.body.style.overflow = '';
        }
      });

      // Exit fullscreen with Escape
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && wrapper.classList.contains('fullscreen')) {
          wrapper.classList.remove('fullscreen');
          document.body.style.overflow = '';
        }
      });

      // Brief delay before auto-play when demo opens (optional enhancement)
      const projectCard = wrapper.closest('.project-card');
      const expandBtn = projectCard?.querySelector('.project-expand');

      if (expandBtn) {
        expandBtn.addEventListener('click', () => {
          const isExpanding = expandBtn.getAttribute('aria-expanded') === 'false';
          if (isExpanding) {
            // Reset video when opening
            video.currentTime = 0;
            updateProgress();
            // Brief delay then play
            setTimeout(() => {
              video.play();
            }, 500);
          } else {
            // Pause when closing
            video.pause();
          }
        });
      }
    });
  </script>
</body>
</html>
